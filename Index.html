<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°ì•  ë ˆì¸ì¦ˆ - ê°œë³„ ë£¨íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        /* ë¯¸ì—°ì‹œ ë°°ê²½ - ë²šê½ƒ í…Œë§ˆ */
        .visual-novel-bg {
            background: linear-gradient(to bottom, #ffd1dc 0%, #ffe4e8 50%, #fff0f3 100%);
            position: relative;
            overflow: hidden;
        }
        
        /* ë– ë‹¤ë‹ˆëŠ” ë²šê½ƒ íš¨ê³¼ */
        .visual-novel-bg::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle, rgba(255, 182, 193, 0.4) 2px, transparent 2px),
                radial-gradient(circle, rgba(255, 192, 203, 0.3) 3px, transparent 3px),
                radial-gradient(circle, rgba(255, 182, 193, 0.5) 2px, transparent 2px);
            background-size: 200px 200px, 300px 300px, 250px 250px;
            background-position: 0 0, 50px 60px, 130px 270px;
            animation: sakuraFall 20s linear infinite;
        }
        
        @keyframes sakuraFall {
            0% { transform: translateY(-100%) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }
        
        /* ë¶€ë“œëŸ¬ìš´ ë¹› íš¨ê³¼ */
        .visual-novel-bg::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
            animation: lightFloat 8s ease-in-out infinite;
        }
        
        @keyframes lightFloat {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(30px, 30px); }
        }
        
        .visual-novel-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(255, 105, 180, 0.3);
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .character-border {
            border: 4px solid;
            border-image: linear-gradient(135deg, #ff69b4, #ff1493, #ff69b4) 1;
            box-shadow: 0 0 20px rgba(255, 105, 180, 0.5);
        }
        
        .stat-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .character-select-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .character-select-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 105, 180, 0.4);
        }

        .cleared-badge {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.5);
        }
    </style>
</head>
<body class="m-0 p-0">
    <div id="app"></div>

    <script>
        // ========== ê²Œì„ ë°ì´í„° ==========
        // ìºë¦­í„° ì´ë¯¸ì§€
        const characterImages = {
            minsu: 'image/minsu.png',
            jieun: 'image/jieun.jpg',
            sujin: 'image/sujin.png',
            seoyeon: 'image/seoyeon.jpg'
        };

        // í•´í”¼ì—”ë”© ì „ìš© ì´ë¯¸ì§€
        const characterHappyImages = {
            minsu: 'image/minsu.png',
            jieun: 'image/jieun.jpg',
            sujin: 'image/sujin.png',
            seoyeon: 'image/seoyeon.jpg'
        };

        const characters = [
            { id: 'minsu', name: 'ê°•ë¯¼ì„œ', age: 28, job: 'ê±´ì¶•ê°€', emoji: 'ğŸ—ï¸', color: 'from-blue-500 to-purple-500' },
            { id: 'jieun', name: 'ì´ì§€ì€', age: 26, job: 'ì„œì  ì£¼ì¸', emoji: 'ğŸ“š', color: 'from-green-500 to-teal-500' },
            { id: 'sujin', name: 'ë°•ìˆ˜ì§„', age: 27, job: 'ë§ˆì¼€í„°', emoji: 'ğŸ’¼', color: 'from-purple-500 to-pink-500' },
            { id: 'seoyeon', name: 'ì •ì„œì—°', age: 29, job: 'ì˜ì‚¬', emoji: 'âš•ï¸', color: 'from-red-500 to-orange-500' }
        ];

        // ê° ìºë¦­í„°ë³„ ê°œë³„ ìŠ¤í† ë¦¬
        const characterStories = {
            minsu: [
                {
                    week: 1,
                    situation: 'ğŸ—ï¸ ì¹´í˜ì—ì„œ ë¯¼ì„œê°€ ì‹¤ìˆ˜ë¡œ ì»¤í”¼ë¥¼ ì—ì§ˆë €ë‹¤\n"ì£„ì†¡í•´ìš”! ì„¸íƒë¹„ ë“œë¦´ê²Œìš”"',
                    leftOption: '"ê´œì°®ì•„ìš”" ì •ì¤‘íˆ ê±°ì ˆ',
                    rightOption: '"ê´œì°®ì•„ìš”" ì„¸íƒë¹„ ë°›ê¸°',
                    leftEffect: { love: 15, money: -5, confidence: 8 },
                    rightEffect: { love: 5, money: 10, confidence: 0 }
                },
                {
                    week: 1,
                    situation: 'ğŸ“± ë¯¼ì„œê°€ ë¬¸ìë¥¼ ë³´ëƒˆë‹¤\n"ì˜¤ëŠ˜ ë­ í•´ìš”? ê°™ì´ ì‚°ì±…í• ë˜ìš”?"',
                    leftOption: '"ì¢‹ì•„ìš”!" ì¦‰ì‹œ ë‹µì¥',
                    rightOption: '"ìƒê°í•´ë³¼ê²Œìš”" ë‚˜ì¤‘ì—',
                    leftEffect: { love: 12, energy: -10 },
                    rightEffect: { love: -5, energy: 5 },
                    interference: { character: 'sujin', text: 'ğŸ’¬ ìˆ˜ì§„ì—ê²Œì„œ ë™ì‹œì— ë©”ì‹œì§€\n"ì €ë… ê°™ì´ ë¨¹ì„ë˜ìš”?"' }
                },
                {
                    week: 2,
                    situation: 'ğŸ’¼ ìƒˆë²½ 2ì‹œ, ë¯¼ì„œì—ê²Œì„œ ë¬¸ì\n"ì•¼ê·¼ ì¤‘... í˜ë“œë„¤ìš” ã… "',
                    leftOption: 'ë°”ë¡œ ì‘ì› ë©”ì‹œì§€',
                    rightOption: 'ìê³  ì•„ì¹¨ì— ë‹µì¥',
                    leftEffect: { love: 15, energy: -15 },
                    rightEffect: { love: -8, energy: 10 }
                },
                {
                    week: 2,
                    situation: 'ğŸ¨ ë¯¼ì„œê°€ ë””ìì¸í•œ ê±´ë¬¼ ëª¨í˜•ì„ ë³´ì—¬ì¤€ë‹¤\n"ë‹¹ì‹  ìƒê°í•˜ë©° ë§Œë“¤ì—ˆì–´ìš”"',
                    leftOption: 'ì§„ì‹¬ìœ¼ë¡œ ì¹­ì°¬í•œë‹¤',
                    rightOption: '"ê´œì°®ë„¤ìš”" ë‹´ë°±í•˜ê²Œ',
                    leftEffect: { love: 20, confidence: -5 },
                    rightEffect: { love: -10, confidence: 10 },
                    interference: { character: 'jieun', text: 'ğŸ“š ì§€ì€ì´ ì „í™”ë¥¼ ê±´ë‹¤\n"ì§€ê¸ˆ ì‹œê°„ ìˆì–´ìš”?"' }
                },
                {
                    week: 3,
                    situation: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ ë¯¼ì„œê°€ ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ\n"ì–´ë¨¸ë‹ˆê°€ ë‹¹ì‹ ì„ ë³´ê³  ì‹¶ëŒ€ìš”"',
                    leftOption: '"ëµ™ê³  ì‹¶ì–´ìš”" ì ê·¹ì ',
                    rightOption: '"ì•„ì§ì€ ë¶€ë‹´ë¼ìš”"',
                    leftEffect: { love: 30, money: -15, energy: -20 },
                    rightEffect: { love: -15, confidence: 5 }
                },
                {
                    week: 3,
                    situation: 'ğŸ½ï¸ ë¯¼ì„œê°€ ê³ ê¸‰ ë ˆìŠ¤í† ë‘ì„ ì˜ˆì•½í–ˆë‹¤\ní†µì¥ ì”ê³ ê°€ ë¶€ì¡±í•˜ë‹¤',
                    leftOption: '"ì œê°€ ë‚¼ê²Œìš”" (í—ˆì„¸)',
                    rightOption: '"...ëˆì´ ì—†ì–´ìš”" (ì†”ì§)',
                    leftEffect: { love: 10, money: -35, confidence: 5 },
                    rightEffect: { love: -20, confidence: -15 },
                    interference: { character: 'seoyeon', text: 'âš•ï¸ ì„œì—°ì´ ìš°ì—°íˆ ë ˆìŠ¤í† ë‘ì—ì„œ ë§Œë‚œë‹¤\n"ì—¬ê¸°ì„œ ë­ í•´ìš”?"' }
                },
                {
                    week: 4,
                    situation: 'ğŸ’¼ ë¯¼ì„œ ì¹œêµ¬ë“¤ì´ ë‹¹ì‹ ì„ ë¬´ì‹œí•œë‹¤\n"ìˆ˜ì…ì´ ì–¼ë§ˆë‚˜ ë¼ìš”?"\në¯¼ì„œëŠ” ë°©ê´€í•˜ê³  ìˆë‹¤',
                    leftOption: 'ì°¸ê³  ì›ƒëŠ”ë‹¤',
                    rightOption: '"ì‹¤ë¡€ë„¤ìš”" í™”ë‚¸ë‹¤',
                    leftEffect: { love: 5, confidence: -25, energy: -15 },
                    rightEffect: { love: -30, confidence: 15 }
                },
                {
                    week: 4,
                    situation: 'ğŸŒ¹ ë‹¹ì‹  ìƒì¼, ë¯¼ì„œê°€ ê¹œì§ íŒŒí‹°ë¥¼ ì¤€ë¹„í–ˆë‹¤\n"ë‹¹ì‹ ì„ ìœ„í•´ ì¤€ë¹„í–ˆì–´ìš”"',
                    leftOption: 'ê°ë™ë°›ìœ¼ë©° í¬ì˜¹',
                    rightOption: '"ë¶€ë‹´ìŠ¤ëŸ¬ì›Œìš”..."',
                    leftEffect: { love: 35, confidence: -10 },
                    rightEffect: { love: -25, confidence: 10 }
                },
                {
                    week: 5,
                    situation: 'âœˆï¸ ë¯¼ì„œê°€ ë³µì¡í•œ í‘œì •ìœ¼ë¡œ\n"1ë…„ í•´ì™¸ í”„ë¡œì íŠ¸ ì œì•ˆì„ ë°›ì•˜ì–´ìš”..."',
                    leftOption: '"ë‹¤ë…€ì˜¤ì„¸ìš”" í¬ìƒì ',
                    rightOption: '"ì €ëŠ” ì–´ë–¡í•´ìš”?" ì†”ì§',
                    leftEffect: { love: 25, energy: -20 },
                    rightEffect: { love: -30, confidence: 15 },
                    interference: { character: 'jieun', text: 'ğŸ“š ì§€ì€ì´ ì „í™”\n"ì–´ë ¤ìš´ ì¼ ìˆì–´ìš”... ë§Œë‚˜ì¤„ë˜ìš”?"' }
                },
                {
                    week: 6,
                    situation: 'âœˆï¸ ì¶œêµ­ D-3\në¯¼ì„œê°€ ì§„ì§€í•˜ê²Œ ë¬»ëŠ”ë‹¤\n"ê°™ì´ ê°ˆë˜ìš”?"',
                    leftOption: '"í•¨ê»˜ ê°ˆê²Œìš”" ë™ë°˜',
                    rightOption: '"ì—¬ê¸° ë‚¨ì„ê²Œìš”"',
                    leftEffect: { love: 50, money: -40, energy: -30 },
                    rightEffect: { love: -35, confidence: 20 }
                }
            ],
            jieun: [
                {
                    week: 1,
                    situation: 'ğŸ“š ì„œì ì—ì„œ ì§€ì€ì´ ì±…ì„ ì¶”ì²œí•œë‹¤\n"ì´ ì±…, ë‹¹ì‹ í•œí…Œ ë”±ì´ì—ìš”"',
                    leftOption: 'ê¸°êº¼ì´ ì‚°ë‹¤',
                    rightOption: '"ë‹¤ìŒì— ë³¼ê²Œìš”"',
                    leftEffect: { love: 15, money: -10, energy: 5 },
                    rightEffect: { love: -8, confidence: 8 }
                },
                {
                    week: 1,
                    situation: 'â˜• ì§€ì€ì´ ì¹´í˜ì—ì„œ ì‹œë¥¼ ì“°ê³  ìˆë‹¤\n"ì˜†ì— ì•‰ì•„ë„ ë¼ìš”?"',
                    leftOption: 'ì¡°ìš©íˆ ì˜†ì— ì•‰ëŠ”ë‹¤',
                    rightOption: '"ì§‘ì¤‘í•˜ì„¸ìš”" ë°°ë ¤',
                    leftEffect: { love: 12, energy: -10 },
                    rightEffect: { love: 5, energy: 5 },
                    interference: { character: 'minsu', text: 'ğŸ—ï¸ ë¯¼ì„œê°€ ìš°ì—°íˆ ê°™ì€ ì¹´í˜ì—\në‹¹ì‹ ì„ ë°œê²¬í•˜ê³  ë‹¤ê°€ì˜¨ë‹¤' }
                },
                {
                    week: 2,
                    situation: 'ğŸ“ ì§€ì€ì´ ì§ì ‘ ì“´ ì‹œë¥¼ ë³´ì—¬ì¤€ë‹¤\n"ë‹¹ì‹  ìƒê°í•˜ë©° ì¼ì–´ìš”..."',
                    leftOption: 'ì§„ì§€í•˜ê²Œ ì½ì–´ì¤€ë‹¤',
                    rightOption: '"ë‚˜ì¤‘ì— ì²œì²œíˆ"',
                    leftEffect: { love: 25, energy: -15 },
                    rightEffect: { love: -12, energy: 5 }
                },
                {
                    week: 2,
                    situation: 'ğŸŒ™ ë°¤ëŠ¦ê²Œ ì§€ì€ì´ ì „í™”í•œë‹¤\n"ë³„ ë³´ëŸ¬ ê°ˆë˜ìš”?"',
                    leftOption: 'í”¼ê³¤í•˜ì§€ë§Œ ë‚˜ê°„ë‹¤',
                    rightOption: '"ë‚´ì¼ì€ ì–´ë•Œìš”?"',
                    leftEffect: { love: 20, energy: -20 },
                    rightEffect: { love: -8, energy: 10 },
                    interference: { character: 'sujin', text: 'ğŸ’¼ ìˆ˜ì§„ì˜ SNS ìŠ¤í† ë¦¬\nìˆ ì§‘ì—ì„œ ì¦ê±°ì›Œí•˜ëŠ” ëª¨ìŠµ' }
                },
                {
                    week: 3,
                    situation: 'ğŸ“‰ ì§€ì€ì˜ ì„œì  í†µì¥ì„ ë´¤ë‹¤\nì”ì•¡ì´ ê±°ì˜ ì—†ë‹¤',
                    leftOption: '"ë„ì™€ì¤„ê²Œìš”" ëˆ ë¹Œë ¤ì¤Œ',
                    rightOption: '"ë‹¤ë¥¸ ë°©ë²• ìˆì„ ê±°ì˜ˆìš”"',
                    leftEffect: { love: 30, money: -25, confidence: -10 },
                    rightEffect: { love: -10, confidence: 15 }
                },
                {
                    week: 3,
                    situation: 'ğŸ­ ì§€ì€ì´ ì‹œ ë‚­ì†¡íšŒì— ì´ˆëŒ€í•œë‹¤\n"ë‹¹ì‹ ì´ ì™€ì¤¬ìœ¼ë©´..."',
                    leftOption: 'ê¼­ ê°€ê² ë‹¤ê³  ì•½ì†',
                    rightOption: '"ìƒê°í•´ë³¼ê²Œìš”"',
                    leftEffect: { love: 25, energy: -15 },
                    rightEffect: { love: -15, energy: 5 },
                    interference: { character: 'seoyeon', text: 'âš•ï¸ ì„œì—°ì´ ê°™ì€ ë‚  ì €ë… ì•½ì†\n"ê¸‰í•œ ì¼ì´ ìƒê²¼ì–´ìš”"' }
                },
                {
                    week: 4,
                    situation: 'ğŸšª ì„œì ì— "íì—…" ì•ˆë‚´ë¬¸\nì§€ì€ì´ ëˆˆë¬¼ì„ ì°¸ëŠ”ë‹¤',
                    leftOption: '"í•¨ê»˜í• ê²Œìš”" ë™í–‰',
                    rightOption: '"ì‘ì›í• ê²Œìš”" ê±°ë¦¬ ë‘ ',
                    leftEffect: { love: 40, money: -20, energy: -25 },
                    rightEffect: { love: -10, energy: 10 }
                },
                {
                    week: 4,
                    situation: 'ğŸ’” ì§€ì€ì´ ë¶ˆì•ˆí•´í•œë‹¤\n"ë‹¹ì‹ ... ë– ë‚  ê±°ì˜ˆìš”?"',
                    leftOption: '"ì ˆëŒ€ ì•ˆ ë– ë‚˜ìš”" í™•ë‹µ',
                    rightOption: '"ì™œ ê·¸ëŸ° ìƒê°ì„?"',
                    leftEffect: { love: 30, confidence: -15 },
                    rightEffect: { love: -15, confidence: 10 }
                },
                {
                    week: 5,
                    situation: 'ğŸ“± ì „ ì—¬ìì¹œêµ¬ì—ê²Œì„œ ì—°ë½\n"í˜ë“¤ì–´... ë§Œë‚˜ì¤„ë˜?"\nì§€ì€ì´ ëˆˆì¹˜ì±˜ë‹¤',
                    leftOption: 'ë§Œë‚˜ì§€ ì•ŠëŠ”ë‹¤',
                    rightOption: 'ì†”ì§íˆ ë§í•˜ê³  ë§Œë‚œë‹¤',
                    leftEffect: { love: 15, confidence: -20 },
                    rightEffect: { love: -35, confidence: 15 },
                    interference: { character: 'minsu', text: 'ğŸ—ï¸ ë¯¼ì„œê°€ ìš°ì—°íˆ ëª©ê²©\nì˜¤í•´í•˜ëŠ” ëˆˆë¹›' }
                },
                {
                    week: 6,
                    situation: 'ğŸ“š ë¶ì¹´í˜ ë™ì—… ì œì•ˆ\n"í•¨ê»˜ ì‹œì‘í•´ìš”. ë‹¹ì‹ ì´ í•„ìš”í•´ìš”"',
                    leftOption: '"ê°™ì´í•´ìš”" ë™ì—…',
                    rightOption: '"ì‘ì›í• ê²Œìš”" ê±°ë¦¬',
                    leftEffect: { love: 50, money: -35, energy: -25 },
                    rightEffect: { love: 5, confidence: 15 }
                }
            ],
            sujin: [
                {
                    week: 1,
                    situation: 'ğŸ’¼ ë§¤ì¹­ ì•±ì—ì„œ ìˆ˜ì§„ì˜ ë©”ì‹œì§€\n"ë‚´ì¼ ë³´ë“œê²Œì„ ì¹´í˜ ã„±ã„±?"',
                    leftOption: '"ì¢‹ì•„ìš”!" ì ê·¹ ë‹µì¥',
                    rightOption: '"ë‹¤ë¥¸ ë‚ ì€?"',
                    leftEffect: { love: 15, money: -10, energy: -10 },
                    rightEffect: { love: -8, energy: 10 }
                },
                {
                    week: 1,
                    situation: 'ğŸ® ë³´ë“œê²Œì„ ì¹´í˜ì—ì„œ ìˆ˜ì§„ê³¼ ê²Œì„ ì¤‘\nìˆ˜ì§„ì´ ê³„ì† ì´ê¸´ë‹¤',
                    leftOption: 'ë´ì£¼ë©´ì„œ ì§„ë‹¤',
                    rightOption: 'ì§„ì§€í•˜ê²Œ ì´ê¸´ë‹¤',
                    leftEffect: { love: 10, confidence: -10 },
                    rightEffect: { love: 15, confidence: 10 },
                    interference: { character: 'jieun', text: 'ğŸ“š ì§€ì€ì´ SNSì— ê°ì„± ê¸€\n"ì™¸ë¡œìš´ ë°¤..."' }
                },
                {
                    week: 2,
                    situation: 'ğŸ“± ìˆ˜ì§„ íœ´ëŒ€í°ì— ì „ ë‚¨ì¹œ ì´ë¦„\nê³„ì† ë‹µì¥í•˜ê³  ìˆë‹¤',
                    leftOption: '"ì•„ì§ë„ ì—°ë½í•´?" ì§ì ‘ ë¬»ê¸°',
                    rightOption: 'ëª» ë³¸ ì²™ ë„˜ì–´ê°€ê¸°',
                    leftEffect: { love: -5, confidence: 15 },
                    rightEffect: { love: 8, confidence: -10 }
                },
                {
                    week: 2,
                    situation: 'ğŸ¤ ìˆ˜ì§„ì´ ë…¸ë˜ë°© ê°€ìê³  í•œë‹¤\n"ë“€ì—£ ë¶€ë¥´ê³  ì‹¶ì–´ìš”!"',
                    leftOption: 'í•¨ê»˜ ë¶€ë¥¸ë‹¤',
                    rightOption: '"ë¶€ë„ëŸ¬ì›Œìš”..."',
                    leftEffect: { love: 20, energy: -15 },
                    rightEffect: { love: -10, energy: 5 },
                    interference: { character: 'seoyeon', text: 'âš•ï¸ ì„œì—°ì´ ì „í™”\n"ì§€ê¸ˆ ì–´ë””ì˜ˆìš”?"' }
                },
                {
                    week: 3,
                    situation: 'â° ìˆ˜ì§„ì´ ì•½ì†ì— 1ì‹œê°„ ëŠ¦ì—ˆë‹¤\në³€ëª…ë„ ì—†ì´ ë‚˜íƒ€ë‚œë‹¤',
                    leftOption: '"ê´œì°®ì•„ìš”" ë„˜ì–´ê°„ë‹¤',
                    rightOption: '"ì™œ ëŠ¦ì—ˆì–´ìš”?" ë”°ì§„ë‹¤',
                    leftEffect: { love: 5, confidence: -15 },
                    rightEffect: { love: -10, confidence: 15 }
                },
                {
                    week: 3,
                    situation: 'ğŸ¢ ë†€ì´ê³µì› ë°ì´íŠ¸\nìˆ˜ì§„ì´ ë¬´ì„œìš´ ë†€ì´ê¸°êµ¬ë¥¼ íƒ€ìê³  í•œë‹¤',
                    leftOption: 'ë¬´ì„­ì§€ë§Œ ê°™ì´ íƒ„ë‹¤',
                    rightOption: '"ë¬´ì„œì›Œìš”..." ì†”ì§',
                    leftEffect: { love: 25, energy: -20 },
                    rightEffect: { love: -5, energy: 5 },
                    interference: { character: 'minsu', text: 'ğŸ—ï¸ ë¯¼ì„œì™€ ë§ˆì£¼ì¹¨\nì–´ìƒ‰í•œ ë¶„ìœ„ê¸°' }
                },
                {
                    week: 4,
                    situation: 'ğŸ’¬ ìˆ˜ì§„ì´ ì§„ì§€í•˜ê²Œ\n"ìš°ë¦¬... ì‚¬ê·€ëŠ” ê±° ë§ì•„?"',
                    leftOption: '"ë‹¹ì—°í•˜ì£ !" í™•ë‹µ',
                    rightOption: '"ì¢€ ë” ì§€ì¼œë´ìš”"',
                    leftEffect: { love: 30, confidence: 15 },
                    rightEffect: { love: -25, energy: 5 }
                },
                {
                    week: 4,
                    situation: 'ğŸ“¸ ìˆ˜ì§„ì´ SNSì— ì»¤í”Œ ì‚¬ì§„ ì˜¬ë¦¬ìê³ \n"ìš°ë¦¬ ì‚¬ì§„ ì˜¬ë¦´ê²Œìš”!"',
                    leftOption: '"ì¢‹ì•„ìš”!" ë™ì˜',
                    rightOption: '"ë‚˜ì¤‘ì—..." ê±°ì ˆ',
                    leftEffect: { love: 25, confidence: 10 },
                    rightEffect: { love: -20, confidence: -10 }
                },
                {
                    week: 5,
                    situation: 'ğŸ˜¢ ìˆ˜ì§„ì´ ê³ ë¯¼ì„ í„¸ì–´ë†“ëŠ”ë‹¤\n"í—Œì‹ ì´ ë¬´ì„œì›Œìš”..."',
                    leftOption: '"ê¸°ë‹¤ë¦´ê²Œìš”" ì¸ë‚´',
                    rightOption: '"ìš°ë¦° ì•ˆ ë§ë‚˜ë´ìš”"',
                    leftEffect: { love: 30, energy: -20 },
                    rightEffect: { love: -40, confidence: 20 },
                    interference: { character: 'jieun', text: 'ğŸ“š ì§€ì€ì´ ìœ„ë¡œê°€ í•„ìš”í•˜ë‹¤ëŠ” ë©”ì‹œì§€\n"í˜ë“  í•˜ë£¨ì˜€ì–´ìš”..."' }
                },
                {
                    week: 6,
                    situation: 'âœˆï¸ ìˆ˜ì§„ì´ ì œì£¼ë„ ì—¬í–‰ì„ ì œì•ˆ\n"3ë°•4ì¼ ê°™ì´ ê°€ìš”!"',
                    leftOption: 'í•¨ê»˜ ê°„ë‹¤',
                    rightOption: '"ëˆì´ ë¶€ì¡±í•´ìš”"',
                    leftEffect: { love: 45, money: -30, energy: -25 },
                    rightEffect: { love: -30, confidence: -15 }
                }
            ],
            seoyeon: [
                {
                    week: 1,
                    situation: 'âš•ï¸ ê²°í˜¼ì‹ì¥ ì˜†ìë¦¬ ì„œì—°\nì¡°ìš©íˆ ëŒ€í™”í•˜ë‹¤ ì—°ë½ì²˜ë¥¼ ë¬¼ì–´ë³¸ë‹¤',
                    leftOption: 'ë¨¼ì € ë²ˆí˜¸ ê±´ë„¨ë‹¤',
                    rightOption: '"ì¸ìŠ¤íƒ€ ì•Œë ¤ë“œë¦´ê²Œìš”"',
                    leftEffect: { love: 15, confidence: 10 },
                    rightEffect: { love: 8, energy: 5 }
                },
                {
                    week: 1,
                    situation: 'â˜• ì„œì—°ì´ ì»¤í”¼ ì•½ì†ì„ ì œì•ˆ\n"ì œ ë³‘ì› ê·¼ì²˜ ì¹´í˜ ì–´ë•Œìš”?"',
                    leftOption: 'ë°”ë¡œ ì•½ì† ì¡ëŠ”ë‹¤',
                    rightOption: '"ë‹¤ìŒ ì£¼ëŠ” ì–´ë•Œìš”?"',
                    leftEffect: { love: 12, money: -10 },
                    rightEffect: { love: -5, energy: 5 },
                    interference: { character: 'sujin', text: 'ğŸ’¼ ìˆ˜ì§„ì´ ê°™ì€ ì‹œê°„ ì•½ì†\n"ì €ë… ë¨¹ìœ¼ëŸ¬ ê°€ìš”"' }
                },
                {
                    week: 2,
                    situation: 'ğŸ¥ ì„œì—°ì—ê²Œì„œ ì „í™”\n"ì‘ê¸‰ í™˜ì... ì•½ì† ì·¨ì†Œí•´ë„ ë ê¹Œìš”?"',
                    leftOption: '"í™˜ìê°€ ë¨¼ì €ì£ !" ì´í•´',
                    rightOption: '"ë˜ìš”?" ì„œìš´í•¨',
                    leftEffect: { love: 20, energy: -10 },
                    rightEffect: { love: -20, confidence: 10 }
                },
                {
                    week: 2,
                    situation: 'ğŸ½ï¸ ì„œì—°ì´ ê³ ê¸‰ ë ˆìŠ¤í† ë‘ì„ ì˜ˆì•½\n"ì œê°€ ë‚¼ê²Œìš”"',
                    leftOption: 'ê³ ë§™ê²Œ ë°›ì•„ë“¤ì¸ë‹¤',
                    rightOption: '"ë°˜ë°˜ ë‚´ìš”" ì£¼ì¥',
                    leftEffect: { love: 10, confidence: -10 },
                    rightEffect: { love: 15, confidence: 10, money: -15 },
                    interference: { character: 'minsu', text: 'ğŸ—ï¸ ë¯¼ì„œê°€ ê°™ì€ ë ˆìŠ¤í† ë‘ì—\në‹¹ì‹ ì„ ë³´ê³  ë†€ë€ë‹¤' }
                },
                {
                    week: 3,
                    situation: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ì„œì—° ë¶€ëª¨ë‹˜ ë§Œë‚¨ ì œì•ˆ\nê³ ê¸‰ í•œì •ì‹ ì˜ˆì•½',
                    leftOption: 'ë§Œë‚˜ëŸ¬ ê°„ë‹¤',
                    rightOption: '"ë¶€ë‹´ìŠ¤ëŸ¬ì›Œìš”" ê±°ì ˆ',
                    leftEffect: { love: 35, money: -20, energy: -25 },
                    rightEffect: { love: -25, confidence: 15 }
                },
                {
                    week: 3,
                    situation: 'â° ì„œì—°ì´ í•­ìƒ ë°”ì˜ë‹¤\në°ì´íŠ¸ë³´ë‹¤ ì¼ì´ ìš°ì„ ',
                    leftOption: 'ì´í•´í•˜ê³  ê¸°ë‹¤ë¦°ë‹¤',
                    rightOption: '"ì‹œê°„ ì¢€ ë‚´ì¤˜ìš”"',
                    leftEffect: { love: 15, energy: -15 },
                    rightEffect: { love: -15, confidence: 15 },
                    interference: { character: 'jieun', text: 'ğŸ“š ì§€ì€ì´ "ì‹œê°„ ë§ì´ ìˆì–´ìš”" ë©”ì‹œì§€' }
                },
                {
                    week: 4,
                    situation: 'ğŸ’ ì„œì—°ì´ ë¯¸ë˜ë¥¼ êº¼ë‚¸ë‹¤\n"ê²°í˜¼ë„ ìƒê°í•´ë³¼ê¹Œìš”?"',
                    leftOption: '"ì¢‹ì•„ìš”" ê¸ì •ì ',
                    rightOption: '"ì•„ì§ì€ ì´ë¥¸ ê²ƒ ê°™ì•„ìš”"',
                    leftEffect: { love: 35, confidence: -15 },
                    rightEffect: { love: -30, confidence: 15 }
                },
                {
                    week: 4,
                    situation: 'ğŸ©º ì„œì—°ì˜ ë™ë£Œê°€ ë‹¹ì‹ ì„ í‰ê°€í•œë‹¤\n"ì„œì—°í•œí…Œ ì–´ìš¸ë¦¬ë‚˜?"',
                    leftOption: 'ì°¸ê³  ì›ƒëŠ”ë‹¤',
                    rightOption: 'ë‹¹ë‹¹í•˜ê²Œ ëŒ€ì‘',
                    leftEffect: { love: 5, confidence: -20 },
                    rightEffect: { love: 20, confidence: 15 }
                },
                {
                    week: 5,
                    situation: 'ğŸ¥ ì„œì—°ì´ í•´ì™¸ ì—°ìˆ˜ ì œì•ˆë°›ìŒ\n"6ê°œì›”ê°„ ë–¨ì–´ì ¸ ìˆì–´ì•¼ í•´ìš”"',
                    leftOption: '"ë‹¤ë…€ì˜¤ì„¸ìš”" ì‘ì›',
                    rightOption: '"ì•ˆ ê°”ìœ¼ë©´..."',
                    leftEffect: { love: 25, energy: -20 },
                    rightEffect: { love: -25, confidence: 10 },
                    interference: { character: 'sujin', text: 'ğŸ’¼ ìˆ˜ì§„ì´ ìœ„ë¡œ ë©”ì‹œì§€\n"í˜ë“¤ë©´ ì—°ë½í•´ìš”"' }
                },
                {
                    week: 6,
                    situation: 'ğŸ’ ì„œì—°ì´ í”„ëŸ¬í¬ì¦ˆë¥¼ ë°›ì•„ë‹¬ë¼ê³ \n"í‰ìƒ í•¨ê»˜í•  ì¤€ë¹„ ëì–´ìš”?"',
                    leftOption: '"ë„¤" ë°›ì•„ë“¤ì¸ë‹¤',
                    rightOption: '"ì‹œê°„ì´ ë” í•„ìš”í•´ìš”"',
                    leftEffect: { love: 50, confidence: -15 },
                    rightEffect: { love: -45, confidence: 20 }
                }
            ]
        };

        const endings = {
            minsu: {
                S: { title: 'í•¨ê»˜ ì„¸ê³„ë¥¼ ê·¸ë¦¬ë‹¤ â­â­â­â­â­', message: 'ë¯¼ì„œê°€ í•´ì™¸ì—ì„œ ëŒì•„ì™”ë‹¤\n"ë‹¹ì‹ ì´ ìˆì–´ì„œ ë²„í…¼ì–´ìš”"\n\níšŒì‚¬ë¥¼ ê·¸ë§Œë‘ê³  í•¨ê»˜ ê±´ì¶• ì‚¬ë¬´ì†Œë¥¼ ì°¨ë ¸ë‹¤\n"ìš°ë¦¬ ì§‘ì„ ê°™ì´ ì„¤ê³„í•´ìš”"\n\nğŸ’ ê²°í˜¼ ì—”ë”©' },
                A: { title: 'ì¥ê±°ë¦¬ì˜ ìŠ¹ë¦¬ â­â­â­â­', message: '1ë…„ì˜ ì¥ê±°ë¦¬ ì—°ì•  ì„±ê³µ\ní™”ìƒí†µí™”ì™€ í¸ì§€ë¡œ ë§ˆìŒì„ ì´ì—ˆë‹¤\n\n"ì´ì œ ë– ë‚˜ì§€ ì•Šì„ê²Œìš”"\n\nğŸ’‘ ì¬íšŒ ì—”ë”©' },
                B: { title: 'í˜„ì‹¤ì  íƒ€í˜‘ â­â­â­', message: 'ì¼ê³¼ ì‚¬ë‘ì˜ ê· í˜•\nê°€ë” ë§Œë‚˜ê³  ì„œë¡œ ì¡´ì¤‘í•œë‹¤\n\n"ì™„ë²½í•˜ì§„ ì•Šì§€ë§Œ ê´œì°®ì•„ìš”"\n\nğŸ¤ ëŠìŠ¨í•œ ê´€ê³„' },
                C: { title: 'ì–´ê¸‹ë‚œ íƒ€ì´ë° â­â­', message: 'ë¯¼ì„œëŠ” ë– ë‚¬ê³  ë‹¹ì‹ ì€ ë‚¨ì•˜ë‹¤\n\n"ê°€ë” ìƒê°ë‚˜ìš”"\n\nğŸ“± ê°€ë” ì—°ë½' },
                D: { title: 'ëƒ‰ì •í•œ ê²°ë³„ â­', message: '"ìš°ë¦° ì•ˆ ë§ì•„ìš”"\n\nì°¨ê°‘ê²Œ ëŒì•„ì„  ë¯¼ì„œ\n\nğŸ’” ì™„ì „ ì´ë³„' }
            },
            jieun: {
                S: { title: 'í•¨ê»˜ ì“°ëŠ” ì´ì•¼ê¸° â­â­â­â­â­', message: 'ë¶ì¹´í˜ë¥¼ í•¨ê»˜ ì—´ì—ˆë‹¤\nì‘ì§€ë§Œ ë”°ëœ»í•œ ê³µê°„\n\n"ë‹¹ì‹ ì´ ì œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ì‹œì˜ˆìš”"\n\nğŸ“– ê¿ˆ ì‹¤í˜„' },
                A: { title: 'ê·¸ì˜ ë®¤ì¦ˆ â­â­â­â­', message: 'ì§€ì€ì˜ ì²« ì‹œì§‘ì´ ì¶œíŒëë‹¤\ní—Œì‚¬ì— ë‹¹ì‹ ì˜ ì´ë¦„ì´ ìˆë‹¤\n\n"ë‹¹ì‹ ì´ ì—†ì—ˆë‹¤ë©´ ì´ ì±…ë„ ì—†ì—ˆì–´ìš”"\n\nâœï¸ ì˜ê°' },
                B: { title: 'ê°ìì˜ ê¸¸ â­â­â­', message: 'ì§€ì€ì€ ì¶œíŒì‚¬ì— ì·¨ì§í–ˆë‹¤\nì£¼ë§ì—ë§Œ ë§Œë‚œë‹¤\n\n"ê·¸ë•Œê°€ ê·¸ë¦½ê¸´ í•´ìš”"\n\nğŸŒ¿ í‰ë²”í•œ ì—°ì¸' },
                C: { title: 'ë¯¸ì•ˆí•œ ë§ˆìŒ â­â­', message: '"ë‚´ê°€ ë„ˆë¬´ ë¬´ê±°ì› ì£ ?"\n\nê²½ì œì  ë¶€ë‹´ì„ ì¤¬ë‹¤ëŠ” ì§€ì€\n\nğŸ˜” ì£„ì±…ê°' },
                D: { title: 'ìƒì²˜ë§Œ ë‚¨ì€ â­', message: '"ë™ì •ì´ì—ˆë‚˜ë´"\n\në¸”ë¡œê·¸ì— ë‹¹ì‹ ì„ ë¹„ë‚œí•˜ëŠ” ì‹œ\n\nğŸ’¢ ì›ë§' }
            },
            sujin: {
                S: { title: 'ììœ ë¡œìš´ ì˜í˜¼ë“¤ â­â­â­â­â­', message: 'í•¨ê»˜ ì„¸ê³„ì—¬í–‰ì„ ë– ë‚¬ë‹¤\nê³„íš ì—†ì´, ì¦‰í¥ì ìœ¼ë¡œ\n\n"ì´ê²Œ ìš°ë¦¬ ë°©ì‹ì´ì£ "\n\nâœˆï¸ ëª¨í—˜' },
                A: { title: 'ì •ì°©í•œ ììœ  â­â­â­â­', message: 'ìˆ˜ì§„ì€ í—Œì‹ ì„ ë°°ì› ë‹¤\nì—¬ì „íˆ ììœ ë¡­ì§€ë§Œ í•¨ê»˜\n\n"ì •ì°©í•˜ê³  ì‹¶ì–´ì¡Œì–´ìš”"\n\nğŸ’‘ ì•ˆì •' },
                B: { title: 'ì¹œêµ¬ ê°™ì€ ì—°ì¸ â­â­â­', message: 'ì• ë§¤í•˜ì§€ë§Œ ì„œë¡œ ë§Œì¡±í•œë‹¤\n\n"ì´ê²ƒë„ ë‚˜ì˜ì§€ ì•Šì–ì•„ìš”"\n\nğŸ˜Š ì• ë§¤í•¨' },
                C: { title: 'íšŒí”¼í˜• ì´ë³„ â­â­', message: '"ì•„ì§ ì¤€ë¹„ ì•ˆ ëì–´ìš”"\n\nì „ ë‚¨ì¹œê³¼ ë‹¤ì‹œ ì—°ë½í•˜ëŠ” ìˆ˜ì§„\n\nğŸ“± íšŒí”¼' },
                D: { title: 'ë°°ì‹ ê° â­', message: 'ë‹¤ë¥¸ ì‚¬ëŒê³¼ ìˆëŠ” ìˆ˜ì§„ì„ ë´¤ë‹¤\n\n"ì°©ê°í•œ ê±° ì•„ë‹ˆì—ìš”?"\n\nğŸ˜¡ ë°°ì‹ ' }
            },
            seoyeon: {
                S: { title: 'ì™„ë²½í•œ íŒŒíŠ¸ë„ˆ â­â­â­â­â­', message: 'í”„ëŸ¬í¬ì¦ˆë¥¼ ë°›ì•„ë“¤ì˜€ë‹¤\n\n1ë…„ í›„, ì•„ë¦„ë‹¤ìš´ ê²°í˜¼ì‹\n"ë‹¹ì‹ ê³¼ë¼ë©´ í‰ìƒë„ ì§§ì•„ìš”"\n\nğŸ’ ê²°í˜¼' },
                A: { title: 'ë“ ë“ í•œ ë™ë°˜ì â­â­â­â­', message: 'ê²°í˜¼ì€ ì•„ì§ì´ì§€ë§Œ ê¹Šì€ ì‹ ë¢°\n\n"ì„œë‘ë¥´ì§€ ì•Šì•„ë„ ë¼ìš”"\n\nğŸ’• ì•½í˜¼ê¸‰' },
                B: { title: 'í˜„ì‹¤ì  ì—°ì¸ â­â­â­', message: 'ì†ë„ê°€ ì•ˆ ë§ì§€ë§Œ ê´€ê³„ ìœ ì§€\n\n"ì²œì²œíˆ ë§ì¶°ê°€ë´ìš”"\n\nâ° ì¡°ìœ¨ì¤‘' },
                C: { title: 'ì‹œê°„ ë¶€ì¡± â­â­', message: 'ë°”ìœ ë³‘ì› ìŠ¤ì¼€ì¤„\n\n"ë¯¸ì•ˆí•´ìš”. ë‚œ ì¼ë„ ì‚¬ë‘ë„ ë†“ì¹  ìˆ˜ ì—†ì–´ìš”"\n\nğŸ“… ì†Œë©¸' },
                D: { title: 'ì°¨ê°€ìš´ ê±°ì ˆ â­', message: '"ì‹œê°„ ë‚­ë¹„í–ˆë„¤ìš”"\n\nì°¨ë‹¨ë‹¹í–ˆë‹¤\n\nğŸš« ì°¨ë‹¨' }
            }
        };

        // ========== ê²Œì„ ìƒíƒœ ==========
        let gameState = {
            phase: 'start',
            selectedCharacter: null,
            stats: { money: 50, energy: 50, confidence: 50 },
            love: 50,
            currentCard: 0,
            week: 1,
            clearedCharacters: []
        };

        // ========== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ==========
        function getLoveEmoji(value) {
            if (value >= 80) return 'â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸';
            if (value >= 60) return 'â¤ï¸â¤ï¸â¤ï¸â¤ï¸ğŸ¤';
            if (value >= 40) return 'â¤ï¸â¤ï¸â¤ï¸ğŸ¤ğŸ¤';
            if (value >= 20) return 'â¤ï¸â¤ï¸ğŸ¤ğŸ¤ğŸ¤';
            return 'â¤ï¸ğŸ¤ğŸ¤ğŸ¤ğŸ¤';
        }

        function getLoveGrade(value) {
            if (value >= 80) return 'S';
            if (value >= 60) return 'A';
            if (value >= 40) return 'B';
            if (value >= 20) return 'C';
            return 'D';
        }

        function checkGameOver(newStats, newLove) {
            if (newLove >= 100) {
                const ending = endings[gameState.selectedCharacter]['S'];
                gameState.endingType = ending.title;
                gameState.endingMessage = ending.message;
                gameState.phase = 'ending';
                if (!gameState.clearedCharacters.includes(gameState.selectedCharacter)) {
                    gameState.clearedCharacters.push(gameState.selectedCharacter);
                }
                return true;
            }
            if (newLove <= 0) {
                const char = characters.find(c => c.id === gameState.selectedCharacter);
                gameState.endingType = `${char.name}ì—ê²Œ ì°¨ì˜€ì–´ìš” ğŸ’”`;
                gameState.endingMessage = `"ë‹¤ì‹  ì—°ë½í•˜ì§€ ë§ˆì„¸ìš”"\n\n${char.name}ì´(ê°€) ë‹¹ì‹ ì„ ì°¨ë‹¨í–ˆë‹¤`;
                gameState.phase = 'ending';
                return true;
            }
            if (newStats.money <= 0) {
                gameState.endingType = 'íŒŒì‚°í–ˆì–´ìš” ğŸ’¸';
                gameState.endingMessage = 'ë°ì´íŠ¸ ë¹„ìš©ì„ ê°ë‹¹í•  ìˆ˜ ì—†ë‹¤\n\n"ë¯¸ì•ˆ... ë‹¹ë¶„ê°„ ëª» ë§Œë‚  ê²ƒ ê°™ì•„"\n\nì¹´ë“œ ëŒ€ê¸ˆì´ ë°€ë ¸ë‹¤';
                gameState.phase = 'ending';
                return true;
            }
            if (newStats.energy <= 0) {
                gameState.endingType = 'ë²ˆì•„ì›ƒ ğŸ˜µ';
                gameState.endingMessage = 'ë„ˆë¬´ ë°”ì˜ê²Œ ì‚´ë‹¤ ì“°ëŸ¬ì¡Œë‹¤\n\në³‘ì› ì¹¨ëŒ€ì—ì„œ ëˆˆì„ ëœ¬ë‹¤\n\n"ì‰¬ëŠ” ê²Œ ì¢‹ê² ì–´ìš”"';
                gameState.phase = 'ending';
                return true;
            }
            if (newStats.confidence <= 0) {
                gameState.endingType = 'ìì¡´ê° ë¶•ê´´ ğŸ˜¢';
                gameState.endingMessage = 'ë„ˆë¬´ ë¹„êµ´í•˜ê²Œ êµ´ì—ˆë‹¤\n\n"ë‹¹ì‹ , ì¢€ í•œì‹¬í•´ ë³´ì—¬ìš”"\n\nì‚¬ë‘ì— ìì‹ ì„ ìƒì—ˆë‹¤';
                gameState.phase = 'ending';
                return true;
            }
            if (newStats.confidence >= 100) {
                gameState.endingType = 'ì˜¤ë§Œí•´ì ¸ì„œ ì°¨ì„ ğŸ˜¤';
                gameState.endingMessage = 'ë„ˆë¬´ ë‹¹ë‹¹í•´ì ¸ì„œ ê±´ë°©ì¡Œë‹¤\n\n"ì™œ ë„¤ ë§ì„ ë“¤ì–´ì•¼ í•´?"\n\n"ì´ë ‡ê²Œ ë³€í•  ì¤„ ëª°ëì–´ìš”"';
                gameState.phase = 'ending';
                return true;
            }
            return false;
        }

        function applyEffect(effect) {
            const newStats = {
                money: Math.max(0, Math.min(100, gameState.stats.money + (effect.money || 0))),
                energy: Math.max(0, Math.min(100, gameState.stats.energy + (effect.energy || 0))),
                confidence: Math.max(0, Math.min(100, gameState.stats.confidence + (effect.confidence || 0)))
            };
            const newLove = Math.max(0, Math.min(100, gameState.love + (effect.love || 0)));
            gameState.stats = newStats;
            gameState.love = newLove;
            if (!checkGameOver(newStats, newLove)) {
                const stories = characterStories[gameState.selectedCharacter];
                if (gameState.currentCard < stories.length - 1) {
                    gameState.currentCard++;
                    const nextWeek = Math.floor(gameState.currentCard / 2) + 1;
                    if (nextWeek > gameState.week) {
                        gameState.week = nextWeek;
                    }
                } else {
                    const grade = getLoveGrade(newLove);
                    const ending = endings[gameState.selectedCharacter][grade];
                    gameState.endingType = ending.title;
                    gameState.endingMessage = ending.message;
                    gameState.phase = 'ending';
                    if (!gameState.clearedCharacters.includes(gameState.selectedCharacter)) {
                        gameState.clearedCharacters.push(gameState.selectedCharacter);
                    }
                }
            }
            render();
        }

        function handleSwipe(direction) {
            const stories = characterStories[gameState.selectedCharacter];
            const card = stories[gameState.currentCard];
            const effect = direction === 'left' ? card.leftEffect : card.rightEffect;
            applyEffect(effect);
        }

        function startGame() {
            gameState.phase = 'character-select';
            render();
        }

        function selectCharacter(charId) {
            gameState.selectedCharacter = charId;
            gameState.phase = 'playing';
            gameState.stats = { money: 50, energy: 50, confidence: 50 };
            gameState.love = 50;
            gameState.currentCard = 0;
            gameState.week = 1;
            render();
        }

        function backToCharacterSelect() {
            gameState.phase = 'character-select';
            gameState.selectedCharacter = null;
            render();
        }

        function restartGame() {
            gameState = {
                phase: 'start',
                selectedCharacter: null,
                stats: { money: 50, energy: 50, confidence: 50 },
                love: 50,
                currentCard: 0,
                week: 1,
                clearedCharacters: gameState.clearedCharacters
            };
            render();
        }

        // ========== ë Œë”ë§ í•¨ìˆ˜ ==========
        function render() {
            const app = document.getElementById('app');
            if (gameState.phase === 'start') {
                app.innerHTML = renderStartScreen();
            } else if (gameState.phase === 'character-select') {
                app.innerHTML = renderCharacterSelect();
            } else if (gameState.phase === 'playing') {
                app.innerHTML = renderGameScreen();
            } else if (gameState.phase === 'ending') {
                app.innerHTML = renderEndingScreen();
            }
        }

        function renderStartScreen() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-400 flex items-center justify-center p-4">
                    <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center">
                        <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                            ì—°ì•  ë ˆì¸ì¦ˆ
                        </h1>
                        <p class="text-gray-600 mb-8">ë‹¹ì‹ ì˜ ì„ íƒì´ ì‚¬ë‘ì„ ê²°ì •í•©ë‹ˆë‹¤</p>
                        <div class="mb-6 p-4 bg-gradient-to-br from-pink-50 to-purple-50 rounded-xl">
                            <h2 class="text-xl font-bold mb-4">4ëª…ì˜ ì—¬ì„± ìºë¦­í„°</h2>
                            <div class="space-y-3">
                                ${characters.map(char => `
                                    <div class="flex items-center gap-3 bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition-all">
                                        <div class="w-16 h-16 rounded-full bg-gradient-to-br ${char.color} flex items-center justify-center overflow-hidden flex-shrink-0">
                                            <img src="${characterImages[char.id]}" alt="${char.name}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                            <span class="text-3xl" style="display:none;">${char.emoji}</span>
                                        </div>
                                        <div class="text-left">
                                            <div class="font-semibold">${char.name}</div>
                                            <div class="text-sm text-gray-600">${char.age}ì„¸ Â· ${char.job}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <button onclick="startGame()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-xl font-semibold text-lg hover:from-purple-600 hover:to-pink-600 transition-all shadow-lg">
                            ê²Œì„ ì‹œì‘
                        </button>
                        <div class="mt-6 p-4 bg-gray-50 rounded-xl">
                            <p class="text-sm text-gray-600 mb-2">âš ï¸ ê²Œì„ ê·œì¹™</p>
                            <p class="text-xs text-gray-500">
                                ìºë¦­í„° ì„ íƒ â†’ ê°œë³„ ìŠ¤í† ë¦¬ ì§„í–‰<br/>
                                ğŸ‘ˆ ì™¼ìª½ = ì ê·¹ì /í¬ìƒì  ì„ íƒ<br/>
                                ğŸ‘‰ ì˜¤ë¥¸ìª½ = ì†Œê·¹ì /ë³´ì¡´ì  ì„ íƒ
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCharacterSelect() {
            return `
                <div class="min-h-screen visual-novel-bg flex items-center justify-center p-4">
                    <div class="max-w-4xl w-full" style="position: relative; z-index: 1;">
                        <h1 class="text-4xl font-bold text-center mb-8 text-white" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3)">
                            ëˆ„êµ¬ì™€ ì—°ì• í• ê¹Œìš”?
                        </h1>
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            ${characters.map(char => {
                                const isCleared = gameState.clearedCharacters.includes(char.id);
                                return `
                                    <div onclick="selectCharacter('${char.id}')" class="character-select-card visual-novel-card rounded-2xl p-6 relative">
                                        ${isCleared ? `<div class="absolute top-3 right-3 cleared-badge text-xs px-3 py-1 rounded-full font-bold text-gray-800">âœ“ CLEAR</div>` : ''}
                                        <div class="w-32 h-32 mx-auto mb-4 rounded-2xl bg-gradient-to-br ${char.color} flex items-center justify-center overflow-hidden shadow-lg border-4 border-white">
                                            <img src="${characterImages[char.id]}" alt="${char.name}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                            <span class="text-6xl" style="display:none;">${char.emoji}</span>
                                        </div>
                                        <div class="text-center mb-4">
                                            <h2 class="text-2xl font-bold bg-gradient-to-r ${char.color} bg-clip-text text-transparent mb-1">${char.name}</h2>
                                            <p class="text-gray-600">${char.age}ì„¸ Â· ${char.job}</p>
                                        </div>
                                        <p class="text-gray-600 text-sm mb-4 text-center">${getCharacterDescription(char.id)}</p>
                                        <div class="bg-gradient-to-r ${char.color} text-white py-2 rounded-lg text-center font-semibold">ì´ ë£¨íŠ¸ ì‹œì‘í•˜ê¸°</div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        ${gameState.clearedCharacters.length > 0 ? `<div class="text-center text-white mb-4" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3)">í´ë¦¬ì–´: ${gameState.clearedCharacters.length} / ${characters.length}</div>` : ''}
                        <div class="text-center">
                            <button onclick="restartGame()" class="bg-white bg-opacity-20 text-white px-6 py-2 rounded-lg hover:bg-opacity-30 transition-all border border-white border-opacity-50">ì²˜ìŒìœ¼ë¡œ</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function getCharacterDescription(charId) {
            const descriptions = {
                minsu: 'í”„ë¡œì íŠ¸ì— ì—´ì •ì ì¸ ê±´ì¶•ê°€. ë•Œë¡œ ì¼ì— ì¹˜ì´ì§€ë§Œ ë‹¹ì‹ ì„ ìœ„í•œ ì‹œê°„ì€ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤.',
                jieun: 'ê°ì„±ì ì´ê³  ì„¬ì„¸í•œ ì„œì  ì£¼ì¸. ì‘ì€ ì„œì ì„ ìš´ì˜í•˜ë©° ì‹œë¥¼ ì“°ëŠ” ë‚­ë§Œì ì¸ ì˜í˜¼.',
                sujin: 'ììœ ë¶„ë°©í•˜ê³  í™œë°œí•œ ë§ˆì¼€í„°. ì¦‰í¥ì ì´ê³  ì¬ë¯¸ìˆì§€ë§Œ í—Œì‹ ì€ ì¡°ê¸ˆ ë‘ë ¤ì›Œí•©ë‹ˆë‹¤.',
                seoyeon: 'ì°¨ë¶„í•˜ê³  ì´ì„±ì ì¸ ì˜ì‚¬. ë°”ìœ ì¼ì • ì†ì—ì„œë„ ë‹¹ì‹ ì—ê²Œ ì§„ì§€í•˜ê²Œ ë‹¤ê°€ì˜µë‹ˆë‹¤.'
            };
            return descriptions[charId];
        }

        function renderGameScreen() {
            const stories = characterStories[gameState.selectedCharacter];
            const card = stories[gameState.currentCard];
            const character = characters.find(c => c.id === gameState.selectedCharacter);
            return `
                <div class="min-h-screen visual-novel-bg flex items-center justify-center p-4 transition-all duration-500">
                    <div class="max-w-md w-full" style="position: relative; z-index: 1;">
                        <div class="stat-container rounded-xl p-4 mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="text-white font-bold text-shadow" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3)">Week ${gameState.week}</div>
                                <div class="text-white text-sm font-semibold">${character.emoji} ${character.name} ë£¨íŠ¸</div>
                            </div>
                            <div class="mb-3">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="text-white font-semibold text-sm" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3)">ğŸ’– í˜¸ê°ë„</span>
                                    <span class="text-xs">${getLoveEmoji(gameState.love)}</span>
                                </div>
                                <div class="bg-white bg-opacity-30 rounded-full h-3 shadow-inner">
                                    <div class="h-3 rounded-full transition-all duration-300 ${gameState.love < 20 || gameState.love > 80 ? 'animate-pulse' : ''}" style="width: ${gameState.love}%; background: ${gameState.love < 20 ? '#ef4444' : gameState.love > 80 ? 'linear-gradient(to right, #ff1493, #ff69b4)' : 'linear-gradient(to right, #ec4899, #f472b6)'}"></div>
                                </div>
                            </div>
                            ${renderStatBar('ğŸ’°', gameState.stats.money, '#eab308')}
                            ${renderStatBar('âš¡', gameState.stats.energy, '#3b82f6')}
                            ${renderStatBar('ğŸ­', gameState.stats.confidence, '#a855f7')}
                        </div>
                        <div class="visual-novel-card rounded-3xl shadow-2xl p-8">
                            <div class="text-center mb-6">
                                <div class="w-32 h-32 mx-auto mb-4 rounded-full character-border bg-gradient-to-br ${character.color} flex items-center justify-center overflow-hidden">
                                    <img src="${characterImages[character.id]}" alt="${character.name}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <span class="text-6xl" style="display:none;">${character.emoji}</span>
                                </div>
                                <h2 class="text-2xl font-bold bg-gradient-to-r ${character.color} bg-clip-text text-transparent">${character.name}</h2>
                                <p class="text-gray-600">${character.age}ì„¸ Â· ${character.job}</p>
                                <div class="mt-2">${getLoveEmoji(gameState.love)}</div>
                            </div>
                            <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 mb-4 min-h-32 flex items-center justify-center border-2 border-purple-200">
                                <p class="text-gray-800 text-base text-center whitespace-pre-line leading-relaxed font-medium">${card.situation}</p>
                            </div>
                            ${card.interference ? `
                                <div class="bg-red-50 border-2 border-red-200 rounded-xl p-4 mb-4">
                                    <div class="flex items-start gap-2">
                                        <span class="text-2xl">${characters.find(c => c.id === card.interference.character).emoji}</span>
                                        <div>
                                            <div class="font-bold text-red-600 text-sm mb-1">ë°©í•´ ì´ë²¤íŠ¸!</div>
                                            <p class="text-sm text-gray-700">${card.interference.text}</p>
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                            <div class="flex gap-4 mb-4">
                                <button onclick="handleSwipe('left')" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all shadow-md">ğŸ‘ˆ ${card.leftOption}</button>
                                <button onclick="handleSwipe('right')" class="flex-1 bg-gradient-to-r from-pink-500 to-pink-600 text-white py-4 rounded-xl font-semibold hover:from-pink-600 hover:to-pink-700 transition-all shadow-md">${card.rightOption} ğŸ‘‰</button>
                            </div>
                            <p class="text-center text-gray-400 text-sm mb-2">ì¢Œìš°ë¡œ ìŠ¤ì™€ì´í”„í•˜ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</p>
                            <div class="text-center text-gray-500 text-xs">ì¹´ë“œ ${gameState.currentCard + 1} / ${stories.length}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEndingScreen() {
            const character = characters.find(c => c.id === gameState.selectedCharacter);
            const grade = getLoveGrade(gameState.love);
            const isHappyEnding = grade === 'S';
            return `
                <div class="min-h-screen bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center p-4">
                    <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center">
                        ${isHappyEnding ? `
                            <div class="mb-6">
                                <div class="w-64 h-64 mx-auto mb-4 rounded-3xl bg-gradient-to-br ${character.color} flex items-center justify-center overflow-hidden shadow-2xl border-4 border-yellow-400 relative">
                                    <img src="${characterHappyImages[character.id]}" alt="${character.name} Happy Ending" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <span class="text-9xl" style="display:none;">${character.emoji}</span>
                                    <div class="absolute inset-0 bg-gradient-to-tr from-transparent via-white to-transparent opacity-20 animate-pulse"></div>
                                    <div class="absolute top-2 right-2 text-3xl animate-bounce">ğŸ’–</div>
                                    <div class="absolute bottom-2 left-2 text-3xl animate-bounce" style="animation-delay: 0.3s;">ğŸ’•</div>
                                </div>
                                <div class="flex items-center justify-center gap-2 mb-2">
                                    <span class="text-3xl">âœ¨</span>
                                    <h2 class="text-2xl font-bold bg-gradient-to-r ${character.color} bg-clip-text text-transparent">${character.name}</h2>
                                    <span class="text-3xl">âœ¨</span>
                                </div>
                                <div class="inline-block bg-gradient-to-r from-yellow-400 to-orange-400 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg">ğŸ† HAPPY ENDING ğŸ†</div>
                            </div>
                        ` : `
                            <div class="mb-4">
                                <div class="w-24 h-24 mx-auto mb-3 rounded-full bg-gradient-to-br ${character.color} flex items-center justify-center text-5xl overflow-hidden">
                                    <img src="${characterImages[character.id]}" alt="${character.name}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <span style="display:none;">${character.emoji}</span>
                                </div>
                                <h2 class="text-xl font-bold bg-gradient-to-r ${character.color} bg-clip-text text-transparent mb-2">${character.name} ë£¨íŠ¸</h2>
                            </div>
                        `}
                        <h1 class="text-3xl font-bold mb-4">${gameState.endingType}</h1>
                        <p class="text-gray-600 mb-6 whitespace-pre-line">${gameState.endingMessage}</p>
                        <p class="text-sm text-gray-500 mb-6">Week ${gameState.week} ê¹Œì§€ ì§„í–‰</p>
                        <div class="mb-6 p-4 bg-gray-50 rounded-xl">
                            <h3 class="font-semibold mb-3 text-left">ìµœì¢… ê²°ê³¼</h3>
                            <div class="mb-3 text-left">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="text-sm">ğŸ’– ìµœì¢… í˜¸ê°ë„</span>
                                    <span class="text-xs">${getLoveEmoji(gameState.love)}</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-2">
                                    <div class="bg-gradient-to-r from-pink-500 to-red-500 h-2 rounded-full transition-all" style="width: ${gameState.love}%"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">${gameState.love}ì  (${getLoveGrade(gameState.love)}ê¸‰)</div>
                            </div>
                            <div class="mt-4 pt-4 border-t">
                                <h3 class="font-semibold mb-2 text-left">ìµœì¢… ìŠ¤íƒ¯</h3>
                                ${renderStatBar('ğŸ’°', gameState.stats.money, '#eab308')}
                                ${renderStatBar('âš¡', gameState.stats.energy, '#3b82f6')}
                                ${renderStatBar('ğŸ­', gameState.stats.confidence, '#a855f7')}
                            </div>
                        </div>
                        <div class="space-y-3">
                            <button onclick="backToCharacterSelect()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-xl font-semibold hover:from-purple-600 hover:to-pink-600 transition-all">ë‹¤ë¥¸ ìºë¦­í„° ì„ íƒ</button>
                            <button onclick="selectCharacter('${gameState.selectedCharacter}')" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all">${character.name} ë‹¤ì‹œ ë„ì „</button>
                            <button onclick="restartGame()" class="w-full bg-gray-500 text-white py-3 rounded-xl font-semibold hover:bg-gray-600 transition-all">ì²˜ìŒë¶€í„°</button>
                        </div>
                        ${gameState.clearedCharacters.length > 0 ? `
                            <div class="mt-6 p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200">
                                <p class="text-sm font-semibold text-gray-700 mb-2">ğŸ† í´ë¦¬ì–´ í˜„í™©: ${gameState.clearedCharacters.length} / ${characters.length}</p>
                                <div class="flex justify-center gap-2">
                                    ${characters.map(c => `<span class="text-2xl ${gameState.clearedCharacters.includes(c.id) ? '' : 'opacity-30'}">${c.emoji}</span>`).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function renderStatBar(icon, value, color) {
            return `
                <div class="flex items-center gap-2 mb-2">
                    <span class="text-lg drop-shadow">${icon}</span>
                    <div class="flex-1 bg-white bg-opacity-30 rounded-full h-3 shadow-inner">
                        <div class="h-3 rounded-full transition-all duration-300 ${value < 20 || value > 80 ? 'animate-pulse' : ''}" style="width: ${value}%; background: ${value < 20 || value > 80 ? '#ef4444' : color}; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                    </div>
                    <span class="text-white font-bold text-sm w-10 text-right drop-shadow" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3)">${value}</span>
                </div>
            `;
        }

        window.startGame = startGame;
        window.selectCharacter = selectCharacter;
        window.backToCharacterSelect = backToCharacterSelect;
        window.restartGame = restartGame;
        window.handleSwipe = handleSwipe;
        render();
    </script>
</body>
</html>